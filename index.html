<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ruine Comptable</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>Ruine Comptable</h1>
    <nav>
      <a href="index.html">Dashboard</a>
      <a href="client.html">Clients</a>
      <a href="produit.html">Produits</a>
      <a href="stock.html">Stocks</a>
      <a href="reservation.html">Réservations</a>
      <a href="vente.html">Ventes</a>
      <a href="livraison.html">Livraisons</a>
      <a href="facture.html">Factures</a>
      <a href="commande.html">Commandes</a>
    </nav>
  </header>

  <main>
    <section class="dashboard">
      <div class="card" id="totalClients">Clients : 0</div>
      <div class="card" id="totalProduits">Produits : 0</div>
      <div class="card" id="totalStocks">Stocks : 0</div>
      <div class="card" id="totalVentes">Ventes : 0</div>
    </section>

    <section>
      <h2>Ajouter un produit</h2>
      <form id="produitForm">
        <input type="text" id="nom" placeholder="Nom du produit" required>
        <input type="number" id="prix" placeholder="Prix" required>
        <input type="number" id="stock" placeholder="Stock" required>
        <button type="submit">Ajouter</button>
      </form>
    </section>

    <section>
      <h2>Liste des produits</h2>
      <ul id="listeProduits"></ul>
    </section>
  </main>

  <!-- Firebase SDK -->
  <script type="module">
    // Import Firebase SDK
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";

    // Config Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyAyxa2EgwXXvkmITIJ6Cv0n7L6Z1knhnt0",
      authDomain: "ruine-comptable.firebaseapp.com",
      projectId: "ruine-comptable",
      storageBucket: "ruine-comptable.firebasestorage.app",
      messagingSenderId: "259486260658",
      appId: "1:259486260658:web:8b931e4fbf96c6474f98ab",
      measurementId: "G-6PTNNG86ET"
    };

    // Init Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Récupération du formulaire
    const produitForm = document.getElementById("produitForm");
    const listeProduits = document.getElementById("listeProduits");

    // Ajouter produit
    produitForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      const nom = document.getElementById("nom").value;
      const prix = parseFloat(document.getElementById("prix").value);
      const stock = parseInt(document.getElementById("stock").value);

      try {
        await addDoc(collection(db, "produits"), { nom, prix, stock });
        alert("Produit ajouté !");
        produitForm.reset();
        chargerProduits();
      } catch (err) {
        console.error("Erreur :", err);
      }
    });

    // Charger produits
    async function chargerProduits() {
      listeProduits.innerHTML = "";
      const querySnapshot = await getDocs(collection(db, "produits"));
      querySnapshot.forEach((doc) => {
        const produit = doc.data();
        const li = document.createElement("li");
        li.textContent = `${produit.nom} - ${produit.prix} Ar (${produit.stock} en stock)`;
        listeProduits.appendChild(li);
      });
    }

    // Charger au démarrage
    chargerProduits();
  </script>
</body>
</html>
